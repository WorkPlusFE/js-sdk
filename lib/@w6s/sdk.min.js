/*!
 * @w6s/sdk.js v0.0.1
 * (c) 2019 WorkPlusFE
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).WorkPlus={})}(this,function(e){"use strict";function i(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function r(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function u(e){return"[object Function]"===Object.prototype.toString.call(e)}var t=(Object.defineProperty(o.prototype,"_fullPrefix",{get:function(){return this._prefix+":"},enumerable:!0,configurable:!0}),o.prototype._getFullKey=function(e){return this._fullPrefix+e},o.prototype.get=function(e){var t,o=this._getFullKey(e),n=null!=(t=this._storage.getItem(o))?t:"";if(!this.hasKey(o))throw Error("不存在的 key");return JSON.parse(n)},o.prototype.hasKey=function(e){for(var t,o=this._storage,n=!1,i=0;i<o.length;i++){var r=null!=(t=o.key(i))?t:"";r&&r===e&&(n=!0)}return n},o.prototype.add=function(e,t){var o=this._getFullKey(e),n=t;if(l(t)||r(t))n=JSON.stringify(t);else if(!i(t))throw Error("storage 不支持的数据类型");try{this._storage.setItem(o,n)}catch(e){throw Error("storage 添加失败")}},o.prototype.remove=function(e){var t,o=this._getFullKey(e);null===(t=this._storage)||void 0===t||t.removeItem(o)},o.prototype.clear=function(){var o=this;this.forEach(function(e,t){return o.remove(e)})},o.prototype.count=function(){for(var e,t=this._storage,o=this._fullPrefix,n=0,i=0;i<t.length;i++)(null!=(e=t.key(i))?e:"").indexOf(o)||n++;return n},o.prototype.forEach=function(e){for(var t,o=this._storage,n=this._fullPrefix,i=0;i<o.length;i++){var r=null!=(t=o.key(i))?t:"";r.indexOf(n)||e(r,this.get(r))}},o);function o(e){var t,o;if(this._prefix="workplus",this._connector=".",!((null===(t=window)||void 0===t?void 0:t.localStorage)&&(null===(o=window)||void 0===o?void 0:o.sessionStorage)))throw Error("当前环境不支持 storage.");this._prefix=e.prefix||this._prefix,this._connector=e.connector||this._connector,this._storage=window[e.type]}var n=Object.freeze({__proto__:null,sleep:function(t){return new Promise(function(e){setTimeout(function(){return e()},t)})},loadScript:function(n){return new Promise(function(e,t){var o=document.createElement("script");o.type="text/javascript",o.src=n,o.addEventListener("load",function(){return e(o)},!1),o.addEventListener("error",function(){return t(o)},!1),document.head.appendChild(o)})},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isPrimitive:i,isPlainObject:r,isArray:l,isFunction:u}),s=(a.prototype.init=function(e){return(null===(t=window)||void 0===t?void 0:t.navigator.userAgent.includes("workplus"))?!this._isReady||(console.warn("已注入Cordova，无需重新实例化"),!1):(console.warn("当前非workplus环境，请检查重试"),!1);var t},a.prototype._ready=function(e){var t=this;document.addEventListener("deviceready",function(){t._isReady=!0,console.info("Cordova 注入成功"),e&&e()},!1)},a.sendEvent=function(o,n,e,t,i){if(!(t&&i&&u(t)&&u(i)))return new Promise(function(e,t){cordova.exec(e,t,o,n)});cordova.exec(t,i,o,n,e||[])},Object.defineProperty(a.prototype,"isReday",{get:function(){return this._isReady},enumerable:!0,configurable:!0}),a);function a(e){this._isReady=!1,this.init(e)&&this._ready()}var d="WorkPlus_Image";var c=n,v=Object.freeze({__proto__:null,takePhoto:function(e){var t,o,n,i;return s.sendEvent(d,"takePhoto",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},takePhotoWithEdit:function(e){var t,o,n,i;return s.sendEvent(d,"takePhotoWithEdit",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},selectImage:function(e){var t,o,n,i;return s.sendEvent(d,"selectImage",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},selectImageWithEdit:function(e){var t,o,n,i;return s.sendEvent(d,"selectImageWithEdit",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},selectImages:function(e){var t,o,n;return s.sendEvent(d,"selectImages",[{imageKeys:null===(t=e)||void 0===t?void 0:t.imageKeys}],null===(o=e)||void 0===o?void 0:o.success,null===(n=e)||void 0===n?void 0:n.fail)},cleanCompressImage:function(e){var t,o,n,i;return s.sendEvent(d,"cleanCompressImage",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},showImages:function(e){var t,o,n,i;return s.sendEvent(d,"showImages",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},saveImages:function(e){var t,o,n,i;return s.sendEvent(d,"saveImages",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},actionForLongPressImage:function(e){var t,o,n,i;return s.sendEvent(d,"actionForLongPressImage",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},takePicture:function(e){var t,o,n,i;return s.sendEvent(d,"takePicture",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},chooseImages:function(e){var t,o,n,i;return s.sendEvent(d,"chooseImages",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)},takePictureAddWatermark:function(e){var t,o,n,i;return s.sendEvent(d,"takePictureAddWatermark",null!=(o=null===(t=e)||void 0===t?void 0:t.data)?o:[],null===(n=e)||void 0===n?void 0:n.success,null===(i=e)||void 0===i?void 0:i.fail)}});e.Storage=t,e.image=v,e.native={},e.utils=c,e.version="0.0.1",Object.defineProperty(e,"__esModule",{value:!0})});
