/*!
 * @w6s/sdk.js v0.0.1
 * (c) 2019 WorkPlusFE
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).WorkPlus={})}(this,function(e){"use strict";function i(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function r(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function s(e){return"[object Function]"===Object.prototype.toString.call(e)}var t=(Object.defineProperty(n.prototype,"_fullPrefix",{get:function(){return this._prefix+":"},enumerable:!0,configurable:!0}),n.prototype._getFullKey=function(e){return this._fullPrefix+e},n.prototype.get=function(e){var t,n=this._getFullKey(e),o=null!=(t=this._storage.getItem(n))?t:"";if(!this.hasKey(n))throw Error("不存在的 key");return JSON.parse(o)},n.prototype.hasKey=function(e){for(var t,n=this._storage,o=!1,i=0;i<n.length;i++){var r=null!=(t=n.key(i))?t:"";r&&r===e&&(o=!0)}return o},n.prototype.add=function(e,t){var n=this._getFullKey(e),o=t;if(u(t)||r(t))o=JSON.stringify(t);else if(!i(t))throw Error("storage 不支持的数据类型");try{this._storage.setItem(n,o)}catch(e){throw Error("storage 添加失败")}},n.prototype.remove=function(e){var t,n=this._getFullKey(e);null===(t=this._storage)||void 0===t||t.removeItem(n)},n.prototype.clear=function(){var t=this;this.forEach(function(e){return t.remove(e)})},n.prototype.count=function(){for(var e,t=this._storage,n=this._fullPrefix,o=0,i=0;i<t.length;i++)(null!=(e=t.key(i))?e:"").indexOf(n)||o++;return o},n.prototype.forEach=function(e){for(var t,n=this._storage,o=this._fullPrefix,i=0;i<n.length;i++){var r=null!=(t=n.key(i))?t:"";r.indexOf(o)||e(r,this.get(r))}},n);function n(e){var t,n;if(this._prefix="workplus",this._connector=".",!((null===(t=window)||void 0===t?void 0:t.localStorage)&&(null===(n=window)||void 0===n?void 0:n.sessionStorage)))throw Error("当前环境不支持 storage.");this._prefix=e.prefix||this._prefix,this._connector=e.connector||this._connector,this._storage=window[e.type]}var o=Object.freeze({__proto__:null,sleep:function(t){return new Promise(function(e){setTimeout(function(){return e()},t)})},loadScript:function(o){return new Promise(function(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=o,n.addEventListener("load",function(){return e(n)},!1),n.addEventListener("error",function(){return t(n)},!1),document.head.appendChild(n)})},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isPrimitive:i,isPlainObject:r,isArray:u,isFunction:s}),l=(a.prototype.init=function(e){return(null===(t=window)||void 0===t?void 0:t.navigator.userAgent.includes("workplus"))?!this._isReady||(console.warn("已注入Cordova，无需重新实例化"),!1):(console.warn("当前非workplus环境，请检查重试"),!1);var t},a.prototype._ready=function(e){var t=this;document.addEventListener("deviceready",function(){t._isReady=!0,console.info("Cordova 注入成功"),e&&e()},!1)},a.sendEvent=function(e,o,i,r,u){return new Promise(function(t,n){cordova.exec(function(e){return r&&s(r)&&r(e),t(e)},function(e){return u&&s(u)&&u(e),n(e)},e,o,i)})},Object.defineProperty(a.prototype,"isReday",{get:function(){return this._isReady},enumerable:!0,configurable:!0}),a);function a(e){this._isReady=!1,this.init(e)&&this._ready()}var c="WorkPlus_Image";var d=o,v=Object.freeze({__proto__:null,takePhoto:function(e){var t;return l.sendEvent(c,"takePhoto",null!=(t=null===e||void 0===e?void 0:e.data)?t:[],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},takePhotoWithEdit:function(e){var t;return l.sendEvent(c,"takePhotoWithEdit",null!=(t=null===e||void 0===e?void 0:e.data)?t:[],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},selectImage:function(e){var t;return l.sendEvent(c,"selectImage",null!=(t=null===e||void 0===e?void 0:e.data)?t:[],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},selectImageWithEdit:function(e){var t;return l.sendEvent(c,"selectImageWithEdit",null!=(t=null===e||void 0===e?void 0:e.data)?t:[],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},selectImages:function(e){return l.sendEvent(c,"selectImages",[{imageKeys:e.data}],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},cleanCompressImage:function(e){var t;return l.sendEvent(c,"cleanCompressImage",null!=(t=null===e||void 0===e?void 0:e.data)?t:[],null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},showImages:function(e){return l.sendEvent(c,"showImages",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},saveImages:function(e){return l.sendEvent(c,"saveImages",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},actionForLongPressImage:function(e){return l.sendEvent(c,"actionForLongPressImage",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},takePicture:function(e){return l.sendEvent(c,"takePicture",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},chooseImages:function(e){return l.sendEvent(c,"chooseImages",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)},takePictureAddWatermark:function(e){return l.sendEvent(c,"takePictureAddWatermark",e.data,null===e||void 0===e?void 0:e.success,null===e||void 0===e?void 0:e.fail)}});e.Storage=t,e.image=v,e.native={},e.off=function(e,t,n){document.removeEventListener(e,t,n)},e.on=function(e,t,n){document.addEventListener(e,t,n)},e.utils=d,e.version="0.0.1",Object.defineProperty(e,"__esModule",{value:!0})});
